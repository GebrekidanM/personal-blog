{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///E:/LMS/atrsaw/front/hooks/useAuth.js"],"sourcesContent":["// hooks/useAuth.js\r\n'use client';\r\nimport { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\n\r\nconst useAuth = () => {\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('authToken');\r\n    if (token) {\r\n      // Here you could add a step to verify the token with the backend\r\n      // For now, we'll just check if it exists.\r\n      setIsAuthenticated(true);\r\n    } else {\r\n      // If no token, redirect to login page\r\n      router.push('/admin/login');\r\n    }\r\n    setLoading(false);\r\n  }, [router]);\r\n\r\n  return { isAuthenticated, loading };\r\n};\r\n\r\nexport default useAuth;"],"names":[],"mappings":"AAAA,mBAAmB;;;;;AAEnB;AACA;AAFA;;;AAIA,MAAM,UAAU;IACd,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,iNAAQ,EAAC;IACvD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,SAAS,IAAA,+IAAS;IAExB,IAAA,kNAAS,EAAC;QACR,MAAM,QAAQ,aAAa,OAAO,CAAC;QACnC,IAAI,OAAO;YACT,iEAAiE;YACjE,0CAA0C;YAC1C,mBAAmB;QACrB,OAAO;YACL,sCAAsC;YACtC,OAAO,IAAI,CAAC;QACd;QACA,WAAW;IACb,GAAG;QAAC;KAAO;IAEX,OAAO;QAAE;QAAiB;IAAQ;AACpC;uCAEe","debugId":null}},
    {"offset": {"line": 144, "column": 0}, "map": {"version":3,"sources":["file:///E:/LMS/atrsaw/front/app/%28admin%29/admin/posts/page.js"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport Link from 'next/link';\r\nimport useAuth from '../../../../hooks/useAuth';\r\nimport { FiEdit, FiTrash2, FiPlusCircle } from 'react-icons/fi';\r\n\r\nexport default function ManagePostsPage() {\r\n  const { isAuthenticated, loading } = useAuth();\r\n  const [posts, setPosts] = useState([]);\r\n  const [status, setStatus] = useState('Loading posts...');\r\n\r\n  // Function to fetch all posts\r\n  const fetchPosts = async () => {\r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      if (!token) {\r\n        setStatus('Authentication error.');\r\n        return;\r\n      }\r\n      \r\n      // We use the PUBLIC endpoint to get posts\r\n      const res = await axios.get('http://localhost:4000/api/posts');\r\n      setPosts(res.data);\r\n      if (res.data.length === 0) {\r\n        setStatus('No posts found. Create your first one!');\r\n      } else {\r\n        setStatus('');\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Failed to fetch posts:\", err);\r\n      setStatus('Failed to load posts.');\r\n    }\r\n  };\r\n\r\n  // Fetch posts when the component mounts\r\n  useEffect(() => {\r\n    if (isAuthenticated) {\r\n      fetchPosts();\r\n    }\r\n  }, [isAuthenticated]);\r\n\r\n  // Function to handle deleting a post\r\n  const handleDelete = async (postId) => {\r\n    // Ask for confirmation before deleting\r\n    if (!window.confirm('Are you sure you want to delete this post? This action cannot be undone.')) {\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      await axios.delete(`http://localhost:4000/api/posts/${postId}`, {\r\n        headers: { 'x-auth-token': token }\r\n      });\r\n      // Refresh the list of posts after deletion\r\n      fetchPosts();\r\n      setStatus('Post deleted successfully.');\r\n    } catch (err) {\r\n      console.error('Failed to delete post:', err);\r\n      setStatus('Failed to delete post.');\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return <div className=\"text-center py-10\">Loading...</div>;\r\n  }\r\n  if (!isAuthenticated) {\r\n    return null; // The auth hook handles redirection\r\n  }\r\n\r\n  return (\r\n    <div className=\"container mx-auto px-4 py-8\">\r\n      <div className=\"flex justify-between items-center mb-6\">\r\n        <h1 className=\"text-3xl font-bold\">Manage Posts</h1>\r\n        <Link href=\"/admin/posts/new\" className=\"flex items-center bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 transition\">\r\n          <FiPlusCircle className=\"mr-2\" />\r\n          Create New Post\r\n        </Link>\r\n      </div>\r\n\r\n      {status && <p className=\"text-center my-4\">{status}</p>}\r\n\r\n      {posts.length > 0 && (\r\n        <div className=\"bg-white p-6 rounded-lg shadow-md\">\r\n          <table className=\"w-full text-left\">\r\n            <thead>\r\n              <tr className=\"border-b\">\r\n                <th className=\"py-2\">Title</th>\r\n                <th className=\"py-2 hidden md:table-cell\">Category</th>\r\n                <th className=\"py-2 hidden sm:table-cell\">Date</th>\r\n                <th className=\"py-2 text-right\">Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {posts.map((post) => (\r\n                <tr key={post._id} className=\"border-b hover:bg-gray-50\">\r\n                  <td className=\"py-4 font-semibold\">{post.title}</td>\r\n                  <td className=\"py-4 hidden md:table-cell\">{post.category}</td>\r\n                  <td className=\"py-4 hidden sm:table-cell\">\r\n                    {new Date(post.publishedAt).toLocaleDateString()}\r\n                  </td>\r\n                  <td className=\"py-4 flex justify-end space-x-2\">\r\n                    <Link href={`/admin/posts/edit/${post._id}`} className=\"p-2 text-blue-600 hover:text-blue-800\" title=\"Edit\">\r\n                      <FiEdit size={18} />\r\n                    </Link>\r\n                    <button onClick={() => handleDelete(post._id)} className=\"p-2 text-red-600 hover:text-red-800\" title=\"Delete\">\r\n                      <FiTrash2 size={18} />\r\n                    </button>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}