{"version":3,"sources":["turbopack:///[project]/node_modules/next/navigation.js","turbopack:///[project]/lib/api.js","turbopack:///[project]/hooks/useAuth.js","turbopack:///[project]/app/(admin)/admin/posts/page.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n","export const api = process.env.NEXT_PUBLIC_API_URL;","// hooks/useAuth.js\r\n'use client';\r\nimport { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\n\r\nconst useAuth = () => {\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('authToken');\r\n    if (token) {\r\n      // Here you could add a step to verify the token with the backend\r\n      // For now, we'll just check if it exists.\r\n      setIsAuthenticated(true);\r\n    } else {\r\n      // If no token, redirect to login page\r\n      router.push('/admin/login');\r\n    }\r\n    setLoading(false);\r\n  }, [router]);\r\n\r\n  return { isAuthenticated, loading };\r\n};\r\n\r\nexport default useAuth;","'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport Link from 'next/link';\r\nimport useAuth from '../../../../hooks/useAuth';\r\nimport { FiEdit, FiTrash2, FiPlusCircle } from 'react-icons/fi';\r\nimport { api } from '@/lib/api';\r\n\r\nexport default function ManagePostsPage() {\r\n  const { isAuthenticated, loading } = useAuth();\r\n  const [posts, setPosts] = useState([]);\r\n  const [status, setStatus] = useState('Loading posts...');\r\n\r\n  // Function to fetch all posts\r\n  const fetchPosts = async () => {\r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      if (!token) {\r\n        setStatus('Authentication error.');\r\n        return;\r\n      }\r\n      \r\n      // We use the PUBLIC endpoint to get posts\r\n      const res = await axios.get(`${api}/posts`);\r\n      setPosts(res.data);\r\n      if (res.data.length === 0) {\r\n        setStatus('No posts found. Create your first one!');\r\n      } else {\r\n        setStatus('');\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Failed to fetch posts:\", err);\r\n      setStatus('Failed to load posts.');\r\n    }\r\n  };\r\n\r\n  // Fetch posts when the component mounts\r\n  useEffect(() => {\r\n    if (isAuthenticated) {\r\n      fetchPosts();\r\n    }\r\n  }, [isAuthenticated]);\r\n\r\n  // Function to handle deleting a post\r\n  const handleDelete = async (postId) => {\r\n    // Ask for confirmation before deleting\r\n    if (!window.confirm('Are you sure you want to delete this post? This action cannot be undone.')) {\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      const token = localStorage.getItem('authToken');\r\n      await axios.delete(`${api}/posts/${postId}`, {\r\n        headers: { 'x-auth-token': token }\r\n      });\r\n      // Refresh the list of posts after deletion\r\n      fetchPosts();\r\n      setStatus('Post deleted successfully.');\r\n    } catch (err) {\r\n      console.error('Failed to delete post:', err);\r\n      setStatus('Failed to delete post.');\r\n    }\r\n  };\r\n\r\n   if (loading) {\r\n    return <div className=\"flex items-center justify-center min-h-screen\">Loading...</div>;\r\n  }\r\n\r\n  if(isAuthenticated === false && !loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen\"> \r\n        <p className=\"text-red-600 font-bold\">You must be logged in to access this page.</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"container mx-auto px-4 py-8\">\r\n      <Link href=\"/admin/dashboard\" className=\"text-blue-600 hover:underline mb-4 inline-block\">‚Üê Back to Dashboard</Link>\r\n      <div className=\"flex justify-between items-center mb-6\">\r\n        <h1 className=\"text-3xl font-bold\">Manage Posts</h1>\r\n        <Link href=\"/admin/posts/new\" className=\"flex items-center bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 transition\">\r\n          <FiPlusCircle className=\"mr-2\" />\r\n          Create New Post\r\n        </Link>\r\n      </div>\r\n\r\n      {status && <p className=\"text-center my-4\">{status}</p>}\r\n\r\n      {posts.length > 0 && (\r\n        <div className=\"bg-white p-6 rounded-lg shadow-md\">\r\n          <table className=\"w-full text-left\">\r\n            <thead>\r\n              <tr className=\"border-b\">\r\n                <th className=\"py-2\">Title</th>\r\n                <th className=\"py-2 hidden md:table-cell\">Category</th>\r\n                <th className=\"py-2 hidden sm:table-cell\">Date</th>\r\n                <th className=\"py-2 text-right\">Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {posts.map((post) => (\r\n                <tr key={post._id} className=\"border-b hover:bg-gray-50\">\r\n                  <td className=\"py-4 font-semibold\">{post.title}</td>\r\n                  <td className=\"py-4 hidden md:table-cell\">{post.category}</td>\r\n                  <td className=\"py-4 hidden sm:table-cell\">\r\n                    {new Date(post.publishedAt).toLocaleDateString()}\r\n                  </td>\r\n                  <td className=\"py-4 flex justify-end space-x-2\">\r\n                    <Link href={`/admin/posts/edit/${post._id}`} className=\"p-2 text-blue-600 hover:text-blue-800\" title=\"Edit\">\r\n                      <FiEdit size={18} />\r\n                    </Link>\r\n                    <button onClick={() => handleDelete(post._id)} className=\"p-2 text-red-600 hover:text-red-800\" title=\"Delete\">\r\n                      <FiTrash2 size={18} />\r\n                    </button>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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","ignoreList":[0]}